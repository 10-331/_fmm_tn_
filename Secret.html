<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>機密調査書</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #f3f3f3;
    font-family: "Source Han Code JP", "Courier New", monospace;
    color: #222;
  }

  .document {
    max-width: 800px;
    margin: 5vh auto;
    padding: 3em 2em;
    background: #fff;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
    border: 1px solid #ccc;
  }

  h1 {
    font-size: 1em;
    border-bottom: 1px solid #ccc;
    padding-bottom: 0.3em;
    margin-bottom: 1.2em;
    letter-spacing: 0.1em;
  }

  p {
    font-size: 0.85em;
    line-height: 1.8;
    margin: 1em 0;
  }

  /* ====== 黒塗り（ロック中） ====== */
  del {
    background: #ccc;
    color: transparent;
    text-shadow: 0 0 4px #000;
    padding: 0.05em 0.2em;
    border-radius: 2px;
    transition: 160ms ease;
  }

  /* ====== 解錠後は「解除済」っぽく見せる ====== */
  body.unlocked del {
    background: transparent;
    color: #111;
    text-shadow: none;
    box-shadow: inset 0 -0.35em 0 rgba(0,0,0,0.08);
  }

  /* ====== 写真風パーツ ====== */
  .photo-wrap{
    display:flex;
    justify-content:flex-end;
    margin: 0 0 1.2em;
  }
  .photo{
    width: 220px;
    background:#fafafa;
    border:1px solid #cfcfcf;
    box-shadow: 3px 3px 0 rgba(0,0,0,0.06);
    padding:10px 10px 6px;
    transform: rotate(1.2deg);
    position: relative;
  }
  .photo::before{
    content:"";
    position:absolute;
    top:-10px; left:18px;
    width:60px; height:18px;
    background: rgba(240,240,240,0.9);
    border:1px solid #d0d0d0;
    transform: rotate(-6deg);
  }
  .photo img{
    width:100%;
    display:block;
    filter: contrast(1.05) grayscale(0.1);
  }
  .photo figcaption{
    font-size:0.65em;
    color:#666;
    margin-top:6px;
    letter-spacing:0.04em;
  }

  /* ====== 照合UI（控えめ） ====== */
  .auth {
    margin-top: 2em;
    padding: 0.9em 1em;
    border: 1px dashed #bbb;
    background: #fafafa;
  }
  .auth p {
    margin: 0 0 0.6em;
    font-size: 0.8em;
    color: #555;
  }
  .auth .row{
    display:flex;
    gap:0.6em;
    align-items:center;
    flex-wrap:wrap;
  }
  .auth input{
    font-family: inherit;
    padding: 0.55em 0.6em;
    width: 220px;
    border: 1px solid #cfcfcf;
    background: #fff;
  }
  .auth button{
    font-family: inherit;
    padding: 0.58em 0.9em;
    border: 1px solid #cfcfcf;
    background: #fff;
    cursor: pointer;
  }
  .auth button:hover { background:#f1f1f1; }
  .hint{
    margin-top: 0.7em;
    font-size: 0.7em;
    color: #888;
  }
  .status{
    margin-top: 0.7em;
    font-size: 0.75em;
    color: #666;
  }
  .status.bad { color:#8a3b3b; }
  .status.good { color:#3b6a3b; }

  footer {
    text-align: center;
    font-size: 0.7em;
    color: #888;
    margin: 3em 0 1em;
  }

  a.back {
    display: block;
    text-align: center;
    color: #666;
    text-decoration: none;
    margin-top: 3em;
  }
  a.back:hover { text-decoration: underline; }
</style>
</head>
<body>
  <div class="document">
    <h1>機密調査書</h1>

    <div class="photo-wrap">
      <figure class="photo">
        <img src="assets/profile/20520515.jpg" alt="調査対象 写真">
        <figcaption>撮影記録：2054年 / 所持者：記録課</figcaption>
      </figure>
    </div>

    <p>記録　　：2054年 XX月 XX日</p>

    <p>
      氏名　　：不明（当人曰く、村の消失後より忘失）<br>
      　　　　　フィラーと名乗るが戸籍の確認が取れない。<br>
      追記　　：<del>防衛省 地方支部部局治安部 通称S局に所属</del>
    </p>

    <p>年齢　　：推定20歳前後</p>

    <p>
      処置内容：記憶の改ざん<br>
      　　　　　<del>笹井綾</del>の戸籍付与。
    </p>

    <!-- 照合UI：ページの下の方に控えめに置くと自然 -->
    <div class="auth" id="authBox">
      <p>閲覧権限照合（要認証）</p>
      <div class="row">
        <input id="key" type="password" placeholder="ACCESS KEY" autocomplete="off" />
        <button id="unlock" type="button">照合</button>
      </div>
      <div class="hint">※照合失敗は記録されます。</div>
      <div class="status" id="status"></div>
    </div>

    <a href="Character.html" class="back">◀ 戻る</a>
  </div>

  <footer>#溶けて、そのまま雲隠れ</footer>

  <script src="assets/js/menu.js"></script>
  <script>
    // ===== 設定 =====
    const ACCESS_KEY = "SASAI"; // ←ここを好きな合言葉に
    const MAX_FAIL = 3;

    let fail = 0;
    const key = document.getElementById("key");
    const btn = document.getElementById("unlock");
    const status = document.getElementById("status");

    function setStatus(msg, type){
      status.textContent = msg;
      status.className = "status " + (type || "");
    }

    function unlock(){
      document.body.classList.add("unlocked");
      setStatus("照合成功：閲覧権限を確認（ログ：付与済）", "good");
      // もう入力いらない感じにする
      key.disabled = true;
      btn.disabled = true;
      btn.textContent = "照合済";
    }

    btn.addEventListener("click", ()=>{
      const v = (key.value || "").trim();
      if(v === ACCESS_KEY){
        unlock();
      }else{
        fail++;
        setStatus(`照合失敗：${fail}/${MAX_FAIL}（ログ：記録中）`, "bad");
        if(fail >= MAX_FAIL){
          setStatus("警告：不正アクセスの疑い（ログ：送信済）", "bad");
          key.disabled = true;
          btn.disabled = true;
          btn.textContent = "ロック";
        }
      }
    });

    // Enterで照合
    key.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") btn.click();
    });
  </script>
</body>
</html>
